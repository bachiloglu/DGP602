<!DOCTYPE html>
<html>

<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.9.0/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.9.0/addons/p5.dom.min.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
    <meta charset="utf-8">
</head>

<body>
    <script>
    var sel, data, opcion;

    function preload() {
        data = loadTable("https://raw.githubusercontent.com/profesorfaco/grafica_computacional/gh-pages/sesion-03/data/censo-2017.csv", "csv", "header");
        console.log(data);
    }

    function setup() {
        createCanvas(600, 600);
        background(200);
        fill(0);
        noStroke();
        textAlign(CENTER);
        sel = createSelect();
        sel.position(10, 10);
        sel.option('Venezuela');
        sel.option('Peru');
        sel.option('Colombia');
        sel.option('Bolivia');
        sel.option('Haiti');
        sel.changed(mySelectEvent);
        text("inmigrantes venezolanos en Chile", width / 2, 50);
        for (var x = 0; x < 5; x++) {
            ellipse(100 * (x + 1), height / 2, data[x].continuidad * 10);
            text(data[x].universidad, 100 * (x + 1), (height / 2) + 50)
            fill(0);
        }
    }

    function mySelectEvent() {
        clear();
        background(200);
        opcion = sel.value();

        if (opcion == "continuidad") {

            text("% de titulados con continuidad de estudio", width / 2, 50);
            for (var x = 0; x < 5; x++) {
                ellipse(100 * (x + 1), height / 2, data[x].continuidad * 10);
                text(data[x].universidad, 100 * (x + 1), (height / 2) + 50)
                fill(0);
            }

        } else if (opcion == "retención") {

            text("Retención de 1er. año", width / 2, 50);
            for (var x = 0; x < 5; x++) {
                ellipse(100 * (x + 1), height / 2, data[x].retencion / 2);
                text(data[x].universidad, 100 * (x + 1), (height / 2) + 50)
                fill(0);
            }

        } else if (opcion == "duración") {

            text("Duración real (semestres)", width / 2, 50);
            for (var x = 0; x < 5; x++) {
                ellipse(100 * (x + 1), height / 2, data[x].duracion * 3);
                text(data[x].universidad, 100 * (x + 1), (height / 2) + 50)
                fill(0);
            }

        } else {
            text("Say what?!", 100, 200);
        }

    }


    </script>
</body>

</html>
